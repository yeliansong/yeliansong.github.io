<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>wxpy&#43;Turing robot WeChat chat robot -- with source code - LIANSONG&#39;S Blog</title><meta name="Description" content="python widget"><meta property="og:title" content="wxpy&#43;Turing robot WeChat chat robot -- with source code" />
<meta property="og:description" content="python widget" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yeliansong.github.io/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/" /><meta property="og:image" content="https://yeliansong.github.io/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/featured-image.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-28T19:14:00+08:00" />
<meta property="article:modified_time" content="2022-03-28T19:14:00+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://yeliansong.github.io/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/featured-image.png"/>
<meta name="twitter:title" content="wxpy&#43;Turing robot WeChat chat robot -- with source code"/>
<meta name="twitter:description" content="python widget"/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://yeliansong.github.io/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/" /><link rel="prev" href="https://yeliansong.github.io/en/2020-12-31-%E8%BF%90%E7%BB%B4%E8%87%AA%E5%8A%A8%E5%8C%96--ansible/" /><link rel="next" href="https://yeliansong.github.io/en/2022-1-28-%E4%B8%80%E6%AC%A1%E7%94%B1inode-%E5%BC%95%E5%8F%91%E7%9A%84%E6%83%A8%E6%A1%88%E7%88%86%E8%82%9D%E5%9B%9B%E5%B0%8F%E6%97%B6%E7%BB%88%E4%BA%8E%E7%90%86%E8%A7%A3%E4%BA%86inode/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "wxpy+Turing robot WeChat chat robot -- with source code",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/yeliansong.github.io\/en\/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/yeliansong.github.io\/en\/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81\/featured-image.png",
                            "width":  1280 ,
                            "height":  720 
                        }],"genre": "posts","keywords": "Technology、Tools","wordcount":  1316 ,
        "url": "https:\/\/yeliansong.github.io\/en\/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81\/","datePublished": "2022-03-28T19:14:00+08:00","dateModified": "2022-03-28T19:14:00+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "LIANSONG'S Blog","logo": "https:\/\/yeliansong.github.io\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "Liansong"
            },"description": "python widget"
    }
    </script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-193031966-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-193031966-2');
</script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/en/" title="LIANSONG&#39;S Blog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>LIANSONG&#39;S Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/en/posts/"> Posts </a><a class="menu-item" href="/en/tags/"> Tags </a><a class="menu-item" href="/en/categories/"> Categories </a><a class="menu-item" href="/en/categories/documentation/"> Docs </a><a class="menu-item" href="/en/about/"> About </a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/" selected>English</option><option value="/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/">简体中文</option></select>
                    </a><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/en/" title="LIANSONG&#39;S Blog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>LIANSONG&#39;S Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/en/posts/" title="">Posts</a><a class="menu-item" href="/en/tags/" title="">Tags</a><a class="menu-item" href="/en/categories/" title="">Categories</a><a class="menu-item" href="/en/categories/documentation/" title="">Docs</a><a class="menu-item" href="/en/about/" title="">About</a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/" selected>English</option><option value="/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/">简体中文</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">wxpy&#43;Turing robot WeChat chat robot -- with source code</h1><h2 class="single-subtitle">python tools</h2><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/en/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Liansong</a></span>&nbsp;<span class="post-category">included in <a href="/en/categories/technology-classification/"><i class="far fa-folder fa-fw"></i>Technology Classification</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-03-28 19:14:00">2022-03-28 19:14:00</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1316 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;7 minutes&nbsp;<span id="busuanzi_container_page_pv">
                    <i class="far fa-eye fa-fw"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;次阅读量</span>
                </span>
            </div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/featured-image.png"
        data-srcset="/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/featured-image.png, /en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/featured-image.png 1.5x, /en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/featured-image.png 2x"
        data-sizes="auto"
        alt="/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/featured-image.png"
        title="python widget" /></div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#21-tools">2.1 Tools</a></li>
    <li><a href="#22-the-whole-principle">2.2 The whole principle</a></li>
    <li><a href="#23-implementation-steps">2.3 Implementation steps</a></li>
    <li><a href="#24-improved-version">2.4 Improved version</a></li>
    <li><a href="#25-project-source-code">2.5 Project source code</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="1-background">1 Background</h1>
<p>I saw a lot of friends using WeChat to play chatbots, and they can reply automatically. They look pretty decent, and I feel itchy. I also want to make a chatbot by myself. The initial idea is to be able to send &ldquo;Good morning&rdquo; to my girlfriend on a regular basis every day &ldquo;News, push the weather of the day, introduce a Turing robot that can automatically reply to your girlfriend&rsquo;s message, and try to answer as level as possible.</p>
<h1 id="2-solution-implementation">2 Solution implementation</h1>
<h2 id="21-tools">2.1 Tools</h2>
<ul>
<li>Two WeChat IDs for testing</li>
<li>Call wxpy python library</li>
<li>python3.5 and above</li>
<li>Register Turing Robot</li>
</ul>
<h2 id="22-the-whole-principle">2.2 The whole principle</h2>
<p>The principle is very simple. On the basis of itchat, wxpy optimizes some interfaces, improves the ease of use of module calls, and expands some functions. Everyone knows that itchat is an open source WeChat personal account interface. Here are some things that wxpy can do:</p>
<ul>
<li>
<p>Control routers, smart homes and other gadgets with open interfaces</p>
</li>
<li>
<p>Automatically send logs to your WeChat when running scripts</p>
</li>
<li>
<p>Add the group owner as a friend and automatically pull into the group</p>
</li>
<li>
<p>Forward messages across numbers or groups</p>
</li>
<li>
<p>Chat with people automatically</p>
</li>
<li>
<p>funny</p>
</li>
</ul>
<p>-&hellip;</p>
<p>Attach the github of wxpy: <a href="https://github.com/youfou/wxpy" target="_blank" rel="noopener noreffer">https://github.com/youfou/wxpy</a></p>
<p>The principle is also very simple. wxpy uses the web version of WeChat API to realize contact search and message sending in WeChat. At the same time, wxpy supports the Turing robot interface, so the robot&rsquo;s automatic reply can be sent. **It should be noted here that if your WeChat does not support web version login, the whole thing will not work. **</p>
<h2 id="23-implementation-steps">2.3 Implementation steps</h2>
<blockquote>
<p><strong>install wxpy</strong></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo pip3 install -U wxpy
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>Turing Robot Registration</strong></p>
</blockquote>
<p>You can refer to this link to buy a one-month trial version to play: <a href="https://www.turingapi.com/" target="_blank" rel="noopener noreffer">https://www.turingapi.com/</a></p>
<blockquote>
<p><strong>Code</strong></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># -*- coding: UTF-8 -*- # The user name to prevent the search is Chinese</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">wxpy</span> <span class="kn">import</span> <span class="o">*</span> <span class="c1"># call wxpy package</span>
</span></span><span class="line"><span class="cl"><span class="n">bot</span> <span class="o">=</span> <span class="n">Bot</span><span class="p">()</span> <span class="c1"># Initialize the robot, scan the code to log in</span>
</span></span><span class="line"><span class="cl"><span class="n">friend</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">friends</span><span class="p">()</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;we_test&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#search for friends whose nickname is test</span>
</span></span><span class="line"><span class="cl"><span class="n">friend1</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">friends</span><span class="p">()</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Big Clever&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#Search for friends whose nickname is Big Smart</span>
</span></span><span class="line"><span class="cl"><span class="n">group</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#Search for the group of test</span>
</span></span><span class="line"><span class="cl"><span class="n">tuling</span> <span class="o">=</span> <span class="n">Tuling</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="s1">&#39;58e4c4c.......&#39;</span><span class="p">)</span> <span class="c1">#call Turing robot API</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Actively send a message</span>
</span></span><span class="line"><span class="cl"><span class="n">friend</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;hello world&#39;</span><span class="p">)</span> <span class="c1">#Send &#39;hello world&#39; to the test friend</span>
</span></span><span class="line"><span class="cl"><span class="n">group</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;for test&#39;</span><span class="p">)</span> <span class="c1">#Send a message to the test group</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#automatic response</span>
</span></span><span class="line"><span class="cl"><span class="nd">@bot.register</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">reply_my_friend</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">     <span class="n">tuling</span><span class="o">.</span><span class="n">do_reply</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="c1"># Turing robot auto-reply</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@bot.register</span><span class="p">(</span><span class="n">friend1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">reply_my_friend1</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">     <span class="n">tuling</span><span class="o">.</span><span class="n">do_reply</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="c1"># Turing robot auto-reply</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="nd">@bot.register</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">reply_my_group</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">chat</span><span class="p">,</span> <span class="n">Group</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">msg</span><span class="o">.</span><span class="n">is_at</span><span class="p">:</span> <span class="c1">#msg.chat and msg.is_at can refer to the document type description. @ I just replied</span>
</span></span><span class="line"><span class="cl">         <span class="k">return</span>
</span></span><span class="line"><span class="cl">     <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">         <span class="n">tuling</span><span class="o">.</span><span class="n">do_reply</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">bot</span><span class="o">.</span><span class="n">join</span><span class="p">()</span> <span class="c1">#Keep logging in</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="24-improved-version">2.4 Improved version</h2>
<p>Just playing some automatic replies is still not interesting. The improved version adds &ldquo;good morning&rdquo; and &ldquo;good night&rdquo; at fixed points every morning and evening, reminds to drink water and move around every hour, and pushes weather information at the same time.
The idea is to add a timing thread, keep running, and then adjust the wxpy interface to send notification messages when the fixed time is reached. To push the weather information, I use the weather API interface of goole, which is also to parse out the required information and send the message after pulling it. I will paste the code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#Push good morning and good night regularly</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">run_thread</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">     <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">]</span> <span class="c1">#Send water drinking notifications at these time points</span>
</span></span><span class="line"><span class="cl">     <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">         <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span> <span class="n">now</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span> <span class="n">now</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">minute</span> <span class="o">==</span> <span class="mi">00</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">second</span> <span class="o">==</span> <span class="mi">00</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">             <span class="n">friend</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;Good morning&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">             <span class="c1"># Get the weather of the day</span>
</span></span><span class="line"><span class="cl">             <span class="n">temp</span><span class="p">,</span> <span class="n">sky</span> <span class="o">=</span> <span class="n">get_weather</span><span class="p">()</span> <span class="c1">#encapsulate a function, call</span>
</span></span><span class="line"><span class="cl">             <span class="n">friend</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;Today&#39;</span><span class="n">s</span> <span class="n">weather</span><span class="p">:</span> <span class="s1">&#39;+ temp + &#39;</span> <span class="s1">&#39; + sky)</span>
</span></span><span class="line"><span class="cl">         <span class="k">elif</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">hour</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">minute</span> <span class="o">==</span> <span class="mi">00</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">second</span> <span class="o">==</span> <span class="mi">00</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">             <span class="n">friend</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;Drink some water, let&#39;</span><span class="n">s</span> <span class="n">move</span> <span class="n">around</span><span class="s1">&#39;)</span>
</span></span><span class="line"><span class="cl">         <span class="k">elif</span> <span class="n">now</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="mi">18</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">minute</span> <span class="o">==</span> <span class="mi">30</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">second</span> <span class="o">==</span> <span class="mi">00</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">             <span class="n">friend</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;It&#39;</span><span class="n">s</span> <span class="n">a</span> <span class="n">hard</span> <span class="n">day</span> <span class="n">at</span> <span class="n">work</span><span class="s1">&#39;)</span>
</span></span><span class="line"><span class="cl">         <span class="k">elif</span> <span class="n">now</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="mi">23</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">minute</span> <span class="o">==</span> <span class="mi">00</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">second</span> <span class="o">==</span> <span class="mi">00</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">             <span class="n">friend</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;It&#39;</span><span class="n">s</span> <span class="n">too</span> <span class="n">late</span><span class="p">,</span> <span class="n">let</span><span class="s1">&#39;s go to bed early&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="n">time</span><span class="o">.</span> <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>API for getting weather</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#Tune google weather API to get weather information</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_weather</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">     <span class="n">city</span> <span class="o">=</span> <span class="s2">&#34;hubei&#34;</span> <span class="c1">#City can be modified</span>
</span></span><span class="line"><span class="cl">     <span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://www.google.com/search?q=&#34;</span><span class="o">+</span><span class="s2">&#34;weather&#34;</span><span class="o">+</span><span class="n">city</span>
</span></span><span class="line"><span class="cl">     <span class="n">html</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span> <span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span> <span class="n">content</span>
</span></span><span class="line"><span class="cl">     <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s1">&#39;html. parser&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># get the temperature</span>
</span></span><span class="line"><span class="cl">     <span class="n">temp</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;BNeawe iBp4i AP7Wnd&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># this contains time and sky description</span>
</span></span><span class="line"><span class="cl">     <span class="nb">str</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;BNeawe tAd8D AP7Wnd&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># format the data</span>
</span></span><span class="line"><span class="cl">     <span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span> <span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">     <span class="n">sky</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># list having all div tags having particular clas sname</span>
</span></span><span class="line"><span class="cl">     <span class="n">listdiv</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span> <span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;BNeawe s3v9rd AP7Wnd&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># particular list with required data</span>
</span></span><span class="line"><span class="cl">     <span class="n">strd</span> <span class="o">=</span> <span class="n">listdiv</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># formatting the string</span>
</span></span><span class="line"><span class="cl">     <span class="n">pos</span> <span class="o">=</span> <span class="n">strd</span><span class="o">.</span> <span class="n">find</span><span class="p">(</span><span class="s1">&#39;Wind&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="n">other_data</span> <span class="o">=</span> <span class="n">strd</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># printing all the data</span>
</span></span><span class="line"><span class="cl">     <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Temperature is&#34;</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="c1">#print(&#34;Time: &#34;, time)</span>
</span></span><span class="line"><span class="cl">     <span class="c1">#print(&#34;Sky Description: &#34;, sky)</span>
</span></span><span class="line"><span class="cl">     <span class="c1">#print(other_data)</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">temp</span><span class="p">,</span> <span class="n">sky</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Simple, the whole function is done.</p>
<h2 id="25-project-source-code">2.5 Project source code</h2>
<p>Some libraries that need to be installed during operation can be installed directly with pip3.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># -*- coding: UTF-8 -*-</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">wxpy</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_weather</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">     <span class="n">city</span> <span class="o">=</span> <span class="s2">&#34;hubei&#34;</span>
</span></span><span class="line"><span class="cl">     <span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://www.google.com/search?q=&#34;</span><span class="o">+</span><span class="s2">&#34;weather&#34;</span><span class="o">+</span><span class="n">city</span>
</span></span><span class="line"><span class="cl">     <span class="n">html</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span> <span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span> <span class="n">content</span>
</span></span><span class="line"><span class="cl">     <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s1">&#39;html. parser&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># get the temperature</span>
</span></span><span class="line"><span class="cl">     <span class="n">temp</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;BNeawe iBp4i AP7Wnd&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># this contains time and sky description</span>
</span></span><span class="line"><span class="cl">     <span class="nb">str</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;BNeawe tAd8D AP7Wnd&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># format the data</span>
</span></span><span class="line"><span class="cl">     <span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span> <span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">     <span class="n">sky</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># list having all div tags having particular clas sname</span>
</span></span><span class="line"><span class="cl">     <span class="n">listdiv</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span> <span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;BNeawe s3v9rd AP7Wnd&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># particular list with required data</span>
</span></span><span class="line"><span class="cl">     <span class="n">strd</span> <span class="o">=</span> <span class="n">listdiv</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># formatting the string</span>
</span></span><span class="line"><span class="cl">     <span class="n">pos</span> <span class="o">=</span> <span class="n">strd</span><span class="o">.</span> <span class="n">find</span><span class="p">(</span><span class="s1">&#39;Wind&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="n">other_data</span> <span class="o">=</span> <span class="n">strd</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1"># printing all the data</span>
</span></span><span class="line"><span class="cl">     <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Temperature is&#34;</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="c1">#print(&#34;Time: &#34;, time)</span>
</span></span><span class="line"><span class="cl">     <span class="c1">#print(&#34;Sky Description: &#34;, sky)</span>
</span></span><span class="line"><span class="cl">     <span class="c1">#print(other_data)</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">temp</span><span class="p">,</span> <span class="n">sky</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Push good morning and good night regularly</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">run_thread</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">     <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">]</span> <span class="c1">#Send water drinking notifications at these time points</span>
</span></span><span class="line"><span class="cl">     <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">         <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span> <span class="n">now</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span> <span class="n">now</span><span class="o">.</span> <span class="n">hour</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span> <span class="n">minute</span> <span class="o">==</span> <span class="mi">00</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">second</span> <span class="o">==</span> <span class="mi">00</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">             <span class="n">friend</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;Good morning&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">             <span class="c1"># Get the weather of the day</span>
</span></span><span class="line"><span class="cl">             <span class="n">temp</span><span class="p">,</span> <span class="n">sky</span> <span class="o">=</span> <span class="n">get_weather</span><span class="p">()</span> <span class="c1">#encapsulate a function, call</span>
</span></span><span class="line"><span class="cl">             <span class="n">friend</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;Today&#39;</span><span class="n">s</span> <span class="n">weather</span><span class="p">:</span> <span class="s1">&#39;+ temp + &#39;</span> <span class="s1">&#39; + sky)</span>
</span></span><span class="line"><span class="cl">         <span class="k">elif</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">hour</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">minute</span> <span class="o">==</span> <span class="mi">00</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">second</span> <span class="o">==</span> <span class="mi">00</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">             <span class="n">friend</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;Drink some water, let&#39;</span><span class="n">s</span> <span class="n">move</span> <span class="n">around</span><span class="s1">&#39;)</span>
</span></span><span class="line"><span class="cl">         <span class="k">elif</span> <span class="n">now</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="mi">18</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">minute</span> <span class="o">==</span> <span class="mi">30</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">second</span> <span class="o">==</span> <span class="mi">00</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">             <span class="n">friend</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;It&#39;</span><span class="n">s</span> <span class="n">a</span> <span class="n">hard</span> <span class="n">day</span> <span class="n">at</span> <span class="n">work</span><span class="s1">&#39;)</span>
</span></span><span class="line"><span class="cl">         <span class="k">elif</span> <span class="n">now</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="mi">23</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">minute</span> <span class="o">==</span> <span class="mi">00</span> <span class="ow">and</span> <span class="n">now</span><span class="o">.</span><span class="n">second</span> <span class="o">==</span> <span class="mi">00</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">             <span class="n">friend</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;It&#39;</span><span class="n">s</span> <span class="n">too</span> <span class="n">late</span><span class="p">,</span> <span class="n">let</span><span class="s1">&#39;s go to bed early&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="n">time</span><span class="o">.</span> <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">     <span class="c1">#Start a thread to run the scheduled task</span>
</span></span><span class="line"><span class="cl">     <span class="n">bot</span> <span class="o">=</span> <span class="n">Bot</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">     <span class="n">friend</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">friends</span><span class="p">()</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;we_test&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">     <span class="n">friend1</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">friends</span><span class="p">()</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;big smart&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">     <span class="n">group</span> <span class="o">=</span> <span class="n">bot</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">     <span class="n">tuling</span> <span class="o">=</span> <span class="n">tuling</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="s1">&#39;58e4c4c..........&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="nd">@bot.register</span><span class="p">(</span><span class="n">friend</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="k">def</span> <span class="nf">reply_my_friend</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">         <span class="n">tuling</span><span class="o">.</span><span class="n">do_reply</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="c1"># Turing robot auto-reply</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="nd">@bot.register</span><span class="p">(</span><span class="n">friend1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="k">def</span> <span class="nf">reply_my_friend1</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">         <span class="n">tuling</span><span class="o">.</span><span class="n">do_reply</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="c1"># Turing robot auto-reply</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="nd">@bot.register</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="k">def</span> <span class="nf">reply_my_group</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">chat</span><span class="p">,</span> <span class="n">Group</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">msg</span><span class="o">.</span><span class="n">is_at</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">             <span class="k">return</span>
</span></span><span class="line"><span class="cl">         <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">             <span class="n">tuling</span><span class="o">.</span><span class="n">do_reply</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">         
</span></span><span class="line"><span class="cl">     <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">run_thread</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;push_msg&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="n">t</span><span class="o">.</span> <span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="n">bot</span><span class="o">.</span><span class="n">join</span><span class="p">()</span> <span class="c1">#Keep logging in</span>
</span></span><span class="line"><span class="cl"><span class="err">```</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2022-03-28 19:14:00</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://yeliansong.github.io/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/" data-title="wxpy&#43;Turing robot WeChat chat robot -- with source code" data-via="xxxx" data-hashtags="Technology、Tools"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://yeliansong.github.io/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/" data-hashtag="Technology、Tools"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://yeliansong.github.io/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://yeliansong.github.io/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/" data-title="wxpy&#43;Turing robot WeChat chat robot -- with source code"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://yeliansong.github.io/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/" data-title="wxpy&#43;Turing robot WeChat chat robot -- with source code"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="Share on 百度" data-sharer="baidu" data-url="https://yeliansong.github.io/en/2022-01-27-wxpy-%E5%9B%BE%E7%81%B5%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BE%AE%E4%BF%A1%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA-%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81/" data-title="wxpy&#43;Turing robot WeChat chat robot -- with source code"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/baidu.svg"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/en/tags/technologytools/">Technology、Tools</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/en/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/en/2020-12-31-%E8%BF%90%E7%BB%B4%E8%87%AA%E5%8A%A8%E5%8C%96--ansible/" class="prev" rel="prev" title="Operation and maintenance automation -- Ansible"><i class="fas fa-angle-left fa-fw"></i>Operation and maintenance automation -- Ansible</a>
            <a href="/en/2022-1-28-%E4%B8%80%E6%AC%A1%E7%94%B1inode-%E5%BC%95%E5%8F%91%E7%9A%84%E6%83%A8%E6%A1%88%E7%88%86%E8%82%9D%E5%9B%9B%E5%B0%8F%E6%97%B6%E7%BB%88%E4%BA%8E%E7%90%86%E8%A7%A3%E4%BA%86inode/" class="next" rel="next" title="A tragedy caused by iNode, I finally understood iNode for four hours.">A tragedy caused by iNode, I finally understood iNode for four hours.<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.115.3">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/en/" target="_blank">LIANSONG&#39;S Blog</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></br>
                <span id="busuanzi_container_site_pv">
                    访问量 <span id="busuanzi_value_site_pv"></span> 次
                </span>
                &nbsp;|&nbsp;
                <span id="busuanzi_container_site_uv">
                    访客数 <span id="busuanzi_value_site_uv"></span> 人次
                </span>
                </br><script>
                    function siteTime() {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = 2021;
                        var startMonth = 3;
                        var startDate = 27;
                        var startHour = 19;
                        var startMinute = 15;
                        var startSecond = 11;
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);
                        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                            minutes);
                        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                            diffMinutes * minutes) / seconds);
                        if (startYear == todayYear) {
                            
                            document.getElementById("sitetime").innerHTML = "已安全运行 " + diffDays + " 天 " + diffHours +
                                " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                        } else {
                            
                            document.getElementById("sitetime").innerHTML = "已安全运行 " + diffYears + " 年 " + diffDays +
                                " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                        }
                    }
                    setInterval(siteTime, 1000);
                </script>
                    <span id="sitetime">载入运行时间...</span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><script type="text/javascript" src="https://.disqus.com/embed.js" defer></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.en","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
